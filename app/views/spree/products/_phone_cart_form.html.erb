<% if (browser.device.mobile?) %>
  <% is_product_available_in_currency = product_available_in_currency? %>
  <% default_variant = default_variant(@variants, @product) %>
  <div class="phone-visible">
    <% if @product&.sale_prices&.active&.present? %>
      <div class="deal-expiry-wrap" id="DealsExpiryPhone" data-SalesExpiryDatePhone="<%= sale_date_time_counter(@product.lowest_expiry_at&.end_at) %>"></div>
    <% end %>
      <%= form_for :order, html: {
          id: 'add-to-cart-form',
          class: 'add-to-cart-form',
          'data-product-summary': @product_summary.to_json,
          'data-variants': product_variants_matrix(is_product_available_in_currency),
          'data-variant-change-trigger-identifier': variant_change_identifier
          } do |f| %>
          <div class="product-options-header d-flex align-items-center justify-content-between" id="inside-product-cart-form" data-hook="inside_product_cart_form">
              <div class="left">Choose your <strong>option:</strong></div>
              <div class="right" id="product_variant_sku"><%= default_variant.sku %></div>
          </div>
          <div class="dropdown size-availability-dropdown">
              <button type="button" class="btn btn-secondary" data-toggle="dropdown">
                <span id="js-select-display-price"><%= display_price(default_variant)%></span>
                <span>/ $6.29 per oz.</span></button>
              <ul class="dropdown-menu size-availability" id="product-variants">
                <% if @product.variants_and_option_values(current_currency).any? %>
                  <% @product.variants_and_option_values(current_currency).each_with_index do |variant, index| %>  
                      <li class="d-flex flex-wrap align-items-center justify-content-between product-ov-js <%= index == 0 ? 'active' : '' %>"
                        data-varient-id="<%= variant.id %>" data-varient-sku="<%= variant.sku %>"data-btn-varient-price="<%= variant.price_in(current_currency).money %>">
                        <% option_value = variant.size_options %>
                        <% if is_product_available_in_currency %>
                          <span class="left  add-to-cart-form-price price selling" content="<%= @product_price.to_d %>"  id="product-price"  data-hook="product_price">
                            <%= display_price(variant) %><span>/ $6.29 per oz.</span></span>
                        <% end %>
                        <div class="right"> 
                          <%= option_value&.presentation %>
                          <% default_id = @product.variants.present? ? @product.variants.first.id : @product.master.id %>
                          <%= hidden_field_tag "variant_id", default_id, id: "selected_variant" %>  
                        </div>
                    </li>
                  <% end%>
                <% else %>
                  <%= hidden_field_tag "variant_id", @product.master.id  %>
                <% end %>
              </ul>
          </div>
          <% default_id = @product.variants.present? ? @product.variants.first.id : @product.master.id %>
          <%= hidden_field_tag "variant_id", default_id, id: "selected_variant" %>
          <div class="add-to-cart-wrap mb-30">
            <label>Quantity:</label>
            <div class="d-flex flex-wrap align-items-center">
              <%= render 'spree/shared/quantity_select', input_name: :quantity %>
              <%= button_tag class: 'btn btn-primary add-to-cart-button', id: 'add-to-cart-button', type: :submit do %>
                <span id="product_btn_variant_price" > <%= default_variant.price_in(current_currency).money %></span>-  <%= Spree.t(:add_to_cart) %>
              <% end %>
            </div>
          </div>
      <% end %>
  </div>
<% end %>
<script type="text/javascript">
  $( document ).on('turbolinks:load', function() {
    var SalesExpiryDatePhone= $('#DealsExpiryPhone').attr("data-SalesExpiryDatePhone");
    var countDownDatePhone = new Date(SalesExpiryDatePhone).getTime();
    var x = setInterval(function() {
      var now = new Date().getTime();
      var distance = countDownDatePhone - now;
      var days = Math.floor(distance / (1000 * 60 * 60 * 24));
      var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      var seconds = Math.floor((distance % (1000 * 60)) / 1000);
    
      $('#DealsExpiryPhone').html("<strong>Deal Expires in: <span>" + days + "</strong> day </span><span><strong>" + hours + "</strong> hours </span><strong><span>"
      + seconds + "</strong> seconds </span> ")
         
      if (distance < 0) {
        clearInterval(x);
        $('#DealsExpiryPhone').html(" Expired ")
      }
    }, 1000);
  });
</script>

